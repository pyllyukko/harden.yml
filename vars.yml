---
allowed_group: users
log_retention_time_in_months: 6
slackware_services:
  - inetd
  - yp
  - cups
  - cups-browsed
  - atd
debian_services:
  - avahi-daemon
  - bluetooth
  - hciuart
  - cups
  - cups-browsed
  - atd
  - ModemManager
  - triggerhappy
  - xinetd
  - inetd
  - rsync
  # for servers
  #- triggerhappy
  #- wpa_supplicant
  #- alsa-restore
  #- alsa-state
  #- hciuart
  # NFS stuff from nfs-common & nfs-kernel-server packages
  - nfs-blkmap
  - nfs-idmapd
  - nfs-mountd
  - nfs-server
  # CIS Debian Linux 12 Benchmark v1.1.0 - 09-26-2024      2.1.12 Ensure rpcbind services are not in use
  # CIS Distribution Independent Linux v2.0.0 - 07-16-2019 2.2.7 Ensure NFS and RPC are not enabled
  - rpcbind
  - wayvnc
allowed_services:
  - sshd
allowed_tcp_ports:
  - 22
sshd_config:
  Ciphers: chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr
  MACs: hmac-sha2-512-etm@openssh.com
  KexAlgorithms: "{% if ansible_facts['distribution'] != \"Ubuntu\" %}mlkem768x25519-sha256,{% endif %}sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256"
  HostKeyAlgorithms: ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512
  MaxAuthTries: 3
  GSSAPIKexAlgorithms: gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group16-sha512-,gss-group14-sha256-
# Value from system-hardening-10.2.txt
fail_delay: 20
session_timeout: 15
nproc_limit: 8192
crypt_rounds: 500000
run_lynis_after_hardening: false
sudo_ids: false
sudo_iolog: false
sudo_group: "{% if ansible_facts['distribution'] == \"Slackware\" %}wheel{% else %}sudo{% endif %}"
aide_conf: "{% if ansible_facts['distribution'] == \"Slackware\" %}/etc/aide.conf{% else %}/etc/aide/aide.conf{% endif %}"
pass_max_days: 365
pass_min_days: 7
pass_warn_age: 30
inactive_password_lock: 30
lynis_location: "{% if ansible_facts['os_family'] == \"RedHat\" or ansible_facts['distribution'] == \"Slackware\" %}/usr/bin/lynis{% else %}/usr/sbin/lynis{% endif %}"
chkrootkit_conf_dir: '/etc/chkrootkit'
cisofy_keyring: /etc/apt/keyrings/cisofy.asc
hsts_max_age: 600
clamav_location: "{% if (ansible_facts['distribution'] == \"Debian\" or ansible_facts['distribution'] == \"Kali\" or ansible_facts['distribution'] == \"Ubuntu\") and ansible_facts['architecture'] == \"x86_64\" %}/usr/local/bin{% else %}/usr/bin{% endif %}"
clamav: {
  'socket': "/run/clamav/clamd.sock",
  'database': "/var/lib/clamav",
  'pid': "/run/clamav/clamd.pid"
}
logind_conf_location: "{% if ansible_facts['distribution'] == \"Slackware\" %}/etc/elogind/logind.conf{% else %}/etc/systemd/logind.conf{% endif %}"
alert_email: 'root'
max_auth_tries: 3
# These system accounts will have additional limits via pam_limits
# sys, man, list, irc, proxy, backup & gnats are from Debian
# See:
#   - /usr/share/base-passwd/passwd.master
#   - /usr/share/doc/base-passwd/users-and-groups.txt.gz
unnecessary_system_accounts:
  - bin
  - adm
  - sys
  - lp
  - sync
  - shutdown
  - man
  - halt
  - mail
  - news
  - uucp
  - operator
  - games
  - ftp
  - smmsp
  - list
  - irc
  - gnats
  - gdm
  - oprofile
  - pop
  #- proxy
  - backup
systemd_services_to_harden:
  - cron
