---
- name: Verify
  hosts: molecule-slackware
  tasks:
    - name: Verify checksums of some of the modified/creates files
      ansible.builtin.shell: 'set -o pipefail; echo "{{ item.value }}  {{ item.key }}" | sha512sum -c'
      register: result
      changed_when:
        - '": OK" not in result.stdout'
      with_dict:
        /etc/ftpusers: 2bed6ea84a50dd68c964f1e2f645716f663fce3526b0f2b85c0cc4b636c3e6317057448fc722641f474d5f64fd7ac7813141479fb3877b8d42733bc9bb4d60b5
        /etc/pam.d/system-auth: 3e59b11565558e9cd823142193e9112d6f2d6e231d3fe31075645e700894bea8d1d5de6be6f2b8feeaae88b664bdca0f2d37f19500ba60e1926fdf57ab494ea2
        /etc/pam.d/postlogin: ad18be719d79d3d7057d162a104dc4962c096369bc3cda98c0d56dee9c6df7cc2d107e2ec1e4923f929b2a0aaf04e5d8f9e5bce0c49f2ceb5c2c4261322f2d1a
        /etc/pam.d/sudo: 5bc411766625659cf7b8c77a552bd628896b0b33925ae43cdbee3c12a0941be6428327ad19eed199dd5201130fff88c910aac7ff779c0b96311a533764e3ac34
        /etc/pam.d/other: c15fa34ee8bcea3c49fb1ffe0be01d4fe645aed9c498f65a6bc815a6b0ea911ed4d15727e34f93323b113905365565e304e2e608dd9a52663a90443598fb8a0c
        /etc/pam.d/remote: c15fa34ee8bcea3c49fb1ffe0be01d4fe645aed9c498f65a6bc815a6b0ea911ed4d15727e34f93323b113905365565e304e2e608dd9a52663a90443598fb8a0c
        /etc/pam.d/login: 26e3aa31985d4f900727df89060ad9859ff446dc0e550ce992eb8c4b3dd4e2b945426eae5fb9f9323d5e776d2505404080d4d1b11201c149d23e59857a984da2
        /etc/pam.d/sshd: 2c80f1940ee43519b2e48375bf57bc79b09a06d9bfe0124dbc9720b632a4fc8061c965cd08c1caccba30e0233b8fa908b06d0925a4826e2227aac08b248eae4a
        /etc/pam.d/su: 2bb407eef69bd412f1564e467d5cdc8fb0d743a583a0e93e119595f8325bea4054055a767aa11cba5fc98328609ed06c7f772e5d9423e65fedda4a39f225dcbf
        /etc/issue: 62b3de7ded026a9ada1fccb94344309525fcf13665ec8c1a474e8d55c9c91c7ac137cb68eaa158060db631b6a53eb6e2ede3003442c66cb002cd790fe222ffd0
        /etc/issue: 62b3de7ded026a9ada1fccb94344309525fcf13665ec8c1a474e8d55c9c91c7ac137cb68eaa158060db631b6a53eb6e2ede3003442c66cb002cd790fe222ffd0
        /etc/motd: deaa93bb519de36a63564ed81ce03dfb7f538323ec3953ca04d363e1480b9157dee47270e846d7341b94d9a3b290b7de151057f82138fa3d44fbfee4c1950c2d
        /etc/security/faillock.conf: 135e0e8e4c8a35d6306df346ac7efa3c5579d713116f2ea7e97cb980de038494dd7d540fcfe1a151e43f2fece85bf1d128b3b64dccd6c770bd78a454d0eb2d12
        /etc/security/namespace.conf: 89512d109d556324b68c7ebc3f01c5f5d6fcc5d1ab8b6fca7a443beba433cadebe3444897285d4d0ae272c056f467c61d9475434e4c8a19c7465aeab75cc4e77
        #/etc/security/limits.conf: 8403608249fd9fbe94ada9df0504f46ffff58612dfc036aa260c066dc4e9241b58984ba1a6152c344bcfeafaa0209ca0cc3b2e0f927f32169d7192b1aee8abe3
        /etc/security/pwquality.conf: 32fa3c6b84913077586332a0491ce41978e0b7061413c71b096138719da1ce2fb005719b1a7a77351920020e5cd63fd251a24373bbbc2b08cb717ce4408ec777
        /etc/default/crond: 56adcdd4d2dd1ebb04ad764229618b69d8cb76a78811b82b3bc442b222a010501f955e8aea6334cadcb30aa40f1cd7c01d44b3c05efb73f6cf18be3f95e19049
        /etc/default/useradd: b77926ee8c445b5cc2bb35b3fb4ac56fbba250180b9fd7d43b5cbb219f8f78c4cbbeb350608b5e09717954ca8e66ec729fc038a046bf5e15804f23d1a9435690
        /etc/rc.d/rc.crond: a59f3240c4c4dce121376050fb5cc9b037fdf9de73f605e2c1bc3c9b1e4dc11467313b474f81adfc619d7f8c42198913c43b74dbe44c37f5eb31f086e79c98e1
        /etc/rc.d/rc.S: 0de8f8175ad51e16d8b3514d9f9a2440feed8ef2e8aa8a524b1c467ed8ea8a847f1e64ff358918bc50b296db48dce60c148c123861eecc1e9dd043557a80d905
        /etc/rc.d/rc.cgconfig: aba623d354a082d74acaf0e2fbd759a5c0fe7ce5b428e294b9faf643e2a72f4c56dc44966ae512fedd179f59bab5bc198ba3aebe6438413d6d8320a7a95467fe
        /etc/ssh/ssh_config: 962eac688d025ba63c24fa734dc7d02d62e16a8f4fd37cb04ff6efe7893b4ba34ece1cdb67d2c4af331b5ba1c339371fa5647b2cc01889a035eff7f51734fa91
        /etc/ssh/sshd_config: f8a3c99a9cf3b86fc948f58c2636893ae85178705b53ea0d824deb5549f97d6505e6ce96967149a4b4c9c832d35efb0c93b4d2d524978119200b9fa030d89ecc
        /etc/ssh/moduli: e57d770b10ea346278a94701c230cba404a4cf148a3320fc797207fb44ff7e8c080bd66b14900f55efa52cc5e6e73cbc3c3d49b9b6cf4d40c897a6969094aaa4
        /etc/sysstat/sysstat: 9f3c56380af28198edf48e5c1e1354e39bbeac4ddaea26ad9b713d8ab9d7873583954516f10c143f8321e1135a3e36a330d10db1547ff0a5f8abc6cd53681a75
        /etc/logrotate.d/pacct: 974fbde7f2ce2c390f02f41c23cf0f82c2dd3fea6d62e1012005eab23124d179741b02ce826beabd8f958e0e231adce45630bcf2ed56083c1f9e7b3f1eec0d84
        /etc/login.defs: 665ac9027fa4a618cad3f9aeedea16a32ce85370ccbd4f90e73cad9e56a8deff79d1bd8a9d23aa003f62326b5324166aa9b5c0ef7858546d65a432e17c6ae91a
        /etc/securetty: 59c89246507c3c6f61ed61ddb2558bb020ce23e5f4b8083b28c2bba487bd3c79382634fa5d936c08808a6558ac03e59fa09e29b578e7f8b5f1c0c1fef5564bdc
        /etc/shutdown.allow: cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e
        /etc/inittab: 02c4acadef92a6bf019e4f36f0bd237599dd4d49303a8063c203367d547cb7f9447b63a5affaebae8519dad999cbcbc5f30e14e29d3cfcc745f0075d9ee7f910
        #/etc/profile: 30b69da92a6ff90079835e79fd9c87bc12d66483a950fd51908f5446bcca3de1cbef2edfbbd7320e8c63af55d1510eeed9afd716ce0cc757e1367f4182cc238c
        /usr/sbin/adduser: 959e6513c44060eed2a94effbeb7c599ea5ef20f25c86017ea9f7f4a33655ea0c52d720cf24fc4e664f29aa69c8c549f4d3695c6b8d699f9c3ab5527fa56142a
        /etc/group: 494488aa79c28da48d54b274f3aa9620c92dda2d65d3c377c240209a3be2c49d98fc39150b4a99a4896c1e8f8eb012b7da87d6f544d2db776d879a4500d64db3
        /etc/gshadow: 0852bd301f403830731c79e45ede27fbc916e8c04f3593eab406965cca0bbb5e0b671ce3b22ccef610dfc395ee7c1122d88850a3f2f74cc27041a0705226d3d1
        /etc/passwd: 754d9da98f9996688dc24dc2f85f5d39400ae807dbd7f588d560b9803da265c3a9f3ac4babb83208d472c317f0773a55cfef369312d1c4246c2326276d8469b1
        /sbin/installpkg: 0097c4421d8d71d330d262cfba1b63d386ba27da3e69ddcfbff94e98f53e73f8cba851261ac955162318af2ee7c0d03a0394ac46b9c01e978e33b802bf311aa5
        /etc/krb5.conf: c45199e7619ccc2ffa43bf24494528eb877658759968d0647961b1a0308997cc2b8295b311169c3a37d79dbfd7f02660ed5accee5a332222aa525d95710d663e
        /etc/shells: ff7739ea88acb9fc8a812ab59cb06055e87939b1c0edf2d1339f023a49ba7336fc33cce64ecc15cfab0279f8c03c3972255148feb51f736078cc9ad85455c956
        /etc/sysctl.d/network.conf: 584a05f1886a0c5b71e017502824795a391f97ecf5a6e28933d10a009963fcb59fc979e728cd2e731682572cd77c057fcd0e5b4170662c55f354b0e9903a2c74
        /etc/sysctl.d/sysctl.conf: 82d72a45f0c21cd10f4486c08af05f6e8df7836c2692b648d44dc2955b36f527c140e048675d21b7c8b25b7fc801e3a3b89d0f03df63009d667f7480f2e8be56
        /etc/modprobe.d/CIS.conf: 53496ebc13d0685281ab15ff9639f62de17e46d88499203499223945d385d9dd95b5f2657d0e78a5c9863ce843840c582acff093f970dcf82f14e86107588417
        /etc/modprobe.d/bashbunny.conf: 167490cbd4519edac09503e328a55bf9e513d2cd50018e8fe79590d8f851eada493785439d422f9f8fce46327b6a24845dd9093a2eaf0d046994b0219288a1bb
        /etc/modprobe.d/firewire.conf: be39b6e9fa54423aca8476b74a2fa05314a994376a750e241affe5fe59b5779953247c22dee8306f7a2b2beb981231bfc11860d106af46b00fe85557117fef12
        /etc/modprobe.d/usb-storage.conf: bd63700828774e0936e3b7e1db108fd91d6f97ef75eeb3fc7e0f6efa028c47a491b0d341164276a8dea7a9454997ca55111fb4731a14cd3889c7e8cb4b8ee10a
        /etc/logrotate.conf: 0db92e0fd8511205021b766888e1bf7a795273b78e1cd1e9ca6d17a49320a2d9b700383375cef0dd7f4ba28d7897325641dcdc183d7c4802de8ef34e24dc6a5b
        /etc/ca-certificates.conf: ec724759132c0d24c13bd5215a80eb086c729e8d19036090167e335852a7cf242263b4229eeddb6fea5d7763ac30c9fa3fe871cf5cb78cb3ed1121795804cfda
    - name: Check that umask is 077 in /etc/profile
      ansible.builtin.lineinfile:
        path: /etc/profile
        line: umask 077
        state: present
        regexp: '^umask 077$'
      check_mode: yes
      register: conf
      failed_when: (conf is changed) or (conf is failed)
